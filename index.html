<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Critics vs Audience: The Double Twist Story</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>

<body>
    <div id="container">

        <!-- PAGE 1: Guessing Game -->
        <section class="page" id="page1">
            <h1>Critics vs Audience: Are They Really That Different?</h1>
            <p class="section-desc">
                Letâ€™s start with a guessing game! Youâ€™ll see a movie poster and one score (Critics or Audience).
                Can you guess the other score using the slider?
            </p>
            <p>TODO: guessing game movie 1</p>
            <p>TODO: guessing game movie 2</p>
            <p>TODO: guessing game movie 3</p>
            <div id="guessing-game-container">
                <!-- ðŸ§© JS will render guessing game (poster + slider + reveal) -->
            </div>
            <button class="load-more" onclick="showNextPage(2, this)">Load More â†“</button>
        </section>


        <!-- PAGE 2: Surprising Outliers -->
        <section class="page hidden" id="page2">
            <h2>Wait... Not Always! Some Movies Break the Pattern</h2>
            <p class="section-desc">
                While many movies have similar Critics and Audience scores, some famous films divide opinions sharply â€”
                like <strong>Joker</strong> or <strong>The Last Jedi</strong>.
            </p>
            <div id="outlier-examples">
                <!-- Example posters + their score differences -->
            </div>
            <button class="load-more" onclick="showNextPage(3, this)">Load More â†“</button>
        </section>


        <!-- PAGE 3: Evidence of Disagreement -->
        <section class="page hidden" id="page3">
            <h2>Look Closer: Critics and Audiences Often Disagree</h2>
            <p class="section-desc">First, by genre: some categories show big differences.</p>
            <div class="chart-container">
                <div id="chart-q1"></div> <!-- Genre difference chart -->
            </div>

            <p class="section-desc">Even their top 30 favorite movies barely overlap.</p>
            <div class="chart-container">
                <div id="chart-q5"></div> <!-- Venn diagram -->
            </div>

            <!-- ðŸ”½ New visualization inserted below Q5 -->
            <h2>Top 50: Critic vs Audience</h2>

            <p class="section-desc">A word-cloud style Venn showing the top 50 movies preferred by each group.</p>
            <div class="chart-container">
                <div id="venn"></div> <!-- New word-cloud Venn visualization -->
            </div>
            <!-- ðŸ”¼ End of new visualization -->

            <button class="load-more" onclick="showNextPage(4, this)">Load More â†“</button>
        </section>


        <!-- PAGE 4: Main Message -->
        <section class="page hidden" id="page4">
            <h2>Theyâ€™re More Aligned Than You Think</h2>
            <p class="section-desc">
                Across thousands of movies and decades of data, the overall correlation between Critics and Audiences
                remains strong â€” especially in recent years.
            </p>
            <div class="chart-container">
                <div id="chart-q2"></div> <!-- Avg Scores Over Time -->
            </div>
            <p>TODO: Oscar visualization</p>
            <button class="load-more" onclick="showNextPage(5, this)">Load More â†“</button>
        </section>


        <!-- PAGE 5: Solution & Recommendation -->
        <section class="page hidden" id="page5">
            <h2>So... Who Should You Trust?</h2>
            <p class="section-desc">
                Turns out, you can trust both. Critics and audiences usually agree on whatâ€™s good.
                Letâ€™s find some movies both groups love!
            </p>
            <div id="recommendation-tool"></div> <!-- Interactive recommender -->
            <p>TODO: interactive recommendation tool </p>
            <p class="footer-note">Created by Team Yilin Jiang, Ylesia Wu, Mingjiao Diao</p>

            <!-- âœ… Start Over Button -->
            <div style="text-align:center; margin-top:40px;">
                <button id="reset-btn" class="load-more">Back to Top â†‘</button>
            </div>
        </section>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script>
        // ------------------------------
        // Handle "Load More" transitions
        // ------------------------------
        function showNextPage(pageNumber, button) {
            const nextPage = document.getElementById(`page${pageNumber}`);
            if (nextPage) {
                nextPage.classList.remove("hidden");
                // Hide the clicked button so it doesnâ€™t trigger again
                if (button) button.style.display = "none";
                // Smoothly scroll to the next section
                nextPage.scrollIntoView({ behavior: "smooth" });

                // âœ… Save progress to localStorage
                localStorage.setItem("lastPage", pageNumber);
            }
        }

        // ------------------------------
        // Restore state on page load
        // ------------------------------
        window.addEventListener("load", () => {
            const lastPage = parseInt(localStorage.getItem("lastPage")) || 1;
            for (let i = 2; i <= lastPage; i++) {
                const section = document.getElementById(`page${i}`);
                if (section) {
                    section.classList.remove("hidden");
                    // Also hide "Load More" buttons for previous pages
                    const prevBtn = document.querySelector(`#page${i - 1} .load-more`);
                    if (prevBtn) prevBtn.style.display = "none";
                }
            }
            // Scroll to the last visible page
            document.getElementById(`page${lastPage}`)?.scrollIntoView({ behavior: "instant" });
        });

        // ------------------------------
        // Reset / Start Over button logic
        // ------------------------------
        document.addEventListener("DOMContentLoaded", () => {
            const resetBtn = document.getElementById("reset-btn");
            resetBtn.addEventListener("click", () => {
                // Clear saved progress
                localStorage.removeItem("lastPage");

                // Hide all sections except page 1
                const pages = document.querySelectorAll(".page");
                pages.forEach((p, i) => {
                    if (i === 0) {
                        p.classList.remove("hidden");
                    } else {
                        p.classList.add("hidden");
                    }
                });

                // Restore all Load More buttons
                document.querySelectorAll(".load-more").forEach(btn => {
                    btn.style.display = "block";
                });

                // Scroll back to top smoothly
                document.getElementById("page1").scrollIntoView({ behavior: "smooth" });
            });
        });
    </script>

    <script src="script.js"></script>
</body>

</html>
